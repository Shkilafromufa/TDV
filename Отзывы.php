<?php
// Начало сессии
session_start();


?>
<!DOCTYPE html>
<html style="font-size: 16px;" lang="ru"><head>
    <!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();
   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
   k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(97936401, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true,
        webvisor:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/97936401" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <title>Отзывы</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
<link rel="stylesheet" href="Главная.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 6.8.9, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": ""
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Отзывы">
    <meta property="og:type" content="website">
  <meta data-intl-tel-input-cdn-path="intlTelInput/"></head>
  <body data-path-to-root="./" data-include-products="false" class="u-body u-xl-mode" data-lang="ru"><header class="u-clearfix u-container-align-center u-header" id="sec-41f8" data-animation-name="" data-animation-duration="0" data-animation-delay="0" data-animation-direction=""><div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <nav class="u-menu u-menu-one-level u-offcanvas u-menu-1">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px; font-weight: 700;">
            <a class="u-button-style u-custom-border u-custom-border-color u-custom-borders u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-active-color u-custom-text-color u-custom-text-hover-color u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg class="u-svg-link" viewBox="0 0 24 24"><use xlink:href="#menu-hamburger"></use></svg>
              <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</g></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-spacing-20 u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-grey-90 u-text-hover-palette-2-base" href="Главная" style="padding: 10px;">Главная</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-grey-90 u-text-hover-palette-2-base" href="Товары-и-услуги" style="padding: 10px;">Товары и услуги</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-grey-90 u-text-hover-palette-2-base" href="Отзывы" style="padding: 10px;">Отзывы</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-grey-90 u-text-hover-palette-2-base" href="profileCheck.php" style="padding: 10px;">Личный кабинет</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Главная">Главная</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Товары-и-услуги">Товары и услуги</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Отзывы">Отзывы</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="profileCheck.php">Личный кабинет</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
<section class="u-clearfix u-image u-shading u-section-1" id="sec-266b" data-image-width="2445" data-image-height="1357">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h1 class="u-text u-text-default u-text-1" data-animation-name="customAnimationIn" data-animation-duration="2000">TDV ENGINEERING </h1>
        <p class="u-text u-text-2">Технологические решения вашего бизнеса </p>
      </div>
    </section>
    
    <main>
        <style>
         main h1 {
        font-size: 2.5rem!important;
    }
        #reviews {
        box-shadow: 10px 10px 10px rgba(0, 73, 255, 0.1), -10px -10px 10px rgba(0, 73, 255, 0.1), 10px -10px 10px rgba(0, 73, 255, 0.1), -10px 10px 10px rgba(0, 73, 255, 0.1);
        }
    h1 {
text-align: center;
    }
    textarea {
        width: 100%;
        height: 100px;
    }
    .review {
        position: relative;
            width: 100%;
            max-width: 1400px;
            margin-top:20px;
            margin-right: auto;
            margin-bottom: 0px;
            margin-left: auto;
            background: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
    }
    .review h3 {
        padding: 10px;
    }

    .review img {
        width: auto;
        height: 500px;
        object-fit: cover;
    }
            form {
  background-color: #f9f9f9;        
  box-shadow: 10px 10px 10px rgba(0, 73, 255, 0.1), -10px -10px 10px rgba(0, 73, 255, 0.1), 10px -10px 10px rgba(0, 73, 255, 0.1), -10px 10px 10px rgba(0, 73, 255, 0.1);
  display: flex;
  flex-direction: column;
  max-width: 1400px;
  margin: auto;
}

form div {
  margin-bottom: 10px;
}

form label {
  font-weight: bold;
}

form input[type="text"],
form textarea {
  width: 100%;
  padding: 5px;
  border-radius: 4px;
}

form button {
  padding: 10px 20px;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

form button:hover {
  background-color: #45a049;
}
.review img {
    width: 100%;
    height: auto;
    max-width: 100vw;
    max-height: 100vh;
    object-fit: cover;
    margin: 0 10px;
}

@media screen and (max-width: 600px) {
    .review img {
        margin: 0;
    }
}
form, #reviews {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 10px;
}

@media screen and (max-width: 1200px) {
    form, #reviews {
        padding: 0 20px;
    }
}

@media screen and (max-width: 600px) {
    form, #reviews {
        padding: 0 10px;
    }
}
#rating {
        display: flex;
        justify-content: center;
        background-color: #f9f9f9;
}
textarea {
    border: 1px;

}
 .star {
     
        font-size: 70px;
        cursor: pointer;
        color: gray;
    }

    .star.active {
        color: gold;
    }

    .star.selected {
        color: gold;
    }
    .item {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
}

.item img {
    width: 20%;
    margin-right: 10px;
}

.item p {
    margin: 0;
    font-size: 12px;
}
textarea {
        resize: none;
    }
textarea::placeholder {
        font-size: 20px;
        padding: 10px;
    }
.itemSelect {
    font-size: 24px;
}
    select {
        font-size: 18px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        background-color: #f9f9f9;
    }

    option {
        font-size: 18px;
    }

    option:hover {
        background-color: #ddd;
    }
     textarea,
    input[type="file"] {
        font-size: 18px;
        padding: 10px;
        background-color: #f9f9f9;
        margin-bottom: 10px;
    }

    input[type="file"]:hover {
        background-color: #7ebc80;
    }
    .rating {
        padding: 10px;
    }
    h1 {
        font-size: 18px;
    }
    .images
{
    width: 70%;
}
.item {
    padding:10px;
    border: 1px solid #ccc;
}
hr {
  border: none;
  height: 1px;
  background-color: #4CAF50;
  margin: 25px 0;
  margin-bottom: 30px;
}
        </style>
        
            

    <!-- Review submission form -->
    <h1>Здесь вы можете написать отзыв на наш товар или услугу</h1><br>
<form id="reviewForm" action="submit_review.php" method="post" enctype="multipart/form-data">
    <br><select id="itemSelect" name="item_id" required>
        <option value="">Выберите товар/услугу</option>
    </select>
    <input type="hidden" name="item_id" value="">
<textarea id="reviewText" name="review_text" required maxlength="500" placeholder="Ваш отзыв" style="height: 352px;"></textarea> <hr>
<input type="hidden" name="rating" value="0">
<div id="rating">
    <span class="star" data-rating="1">&#9733;</span>
    <span class="star" data-rating="2">&#9733;</span>
    <span class="star" data-rating="3">&#9733;</span>
    <span class="star" data-rating="4">&#9733;</span>
    <span class="star" data-rating="5">&#9733;</span>
</div>

    <input type="file" name="images[]">
    <input type="file" name="images[]">
    <input type="file" name="images[]"> <BR>
    <button type="submit">Отправить отзыв</button>
    <span id="charCount">Осталось символов: 500</span>
</form>

    <!-- Reviews section -->
    <section id="reviews"></section>

<script>
// Получаем список товаров/услуг из базы данных
fetch('items-api-reviews')
    .then(response => response.json())
    .then(data => {
        const itemSelect = document.getElementById('itemSelect');
        data.forEach(item => {
            const option = document.createElement('option');
            option.value = item.id;
            option.text = item.title;
            itemSelect.appendChild(option);
        });
    });

// При выборе товара/услуги из выпадающего списка, сохраняем его id в скрытом поле формы
itemSelect.addEventListener('change', function() {
    document.querySelector('input[name="item_id"]').value = this.value;
});











 const ratingDiv = document.getElementById('rating');
    const stars = ratingDiv.getElementsByClassName('star');
    let selectedRating = 0;

    for (let i = 0; i < stars.length; i++) {
        stars[i].addEventListener('mouseover', function() {
            const rating = this.getAttribute('data-rating');
            for (let j = 0; j < stars.length; j++) {
                if (j < rating) {
                    stars[j].classList.add('active');
                } else {
                    stars[j].classList.remove('active');
                }
            }
        });

        stars[i].addEventListener('mouseout', function() {
            for (let j = 0; j < stars.length; j++) {
                stars[j].classList.remove('active');
            }
        });

stars[i].addEventListener('click', function() {
    selectedRating = this.getAttribute('data-rating');
    document.querySelector('input[name="rating"]').value = selectedRating;
    for (let j = 0; j < stars.length; j++) {
        if (j < selectedRating) {
            stars[j].classList.add('selected');
        } else {
            stars[j].classList.remove('selected');
        }
    }
});
    }



const reviewText = document.getElementById('reviewText');
    const charCount = document.getElementById('charCount');

    reviewText.addEventListener('input', function() {
        const remainingChars = 500 - reviewText.value.length;
        charCount.textContent = `Осталось символов: ${remainingChars}`;
    });



    document.addEventListener("DOMContentLoaded", function() {
        // Fetch reviews from reviews.php
        fetch('reviews.php')
            .then(response => response.json())
            .then(data => displayReviews(data))
            .catch(error => console.error('Error:', error));

// Display reviews on the page
function displayReviews(reviews) {
    const reviewsSection = document.getElementById('reviews');

   reviews.forEach(review => {
    const reviewDiv = document.createElement('div');
    reviewDiv.className = 'review';
    reviewDiv.innerHTML = `
        <h3>Пользователь ${review.username}</h3>
        ${review.item_image_url ? `
            <div class="item">
            <h4> Отзыв на предложение: "${review.item_title}"</h4>
                <img src="${review.item_image_url}" alt="${review.item_title}" width="50">
            </div>
        ` : ''}
        <div class="rating">${createStars(review.rating)}</div>
        <p>${review.review_text}</p>
    `;

        // Display images for the review
        if (review.images) {
            const images = review.images.split(',');
            const imagesDiv = document.createElement('div');
            imagesDiv.className = 'images';
            images.forEach(image => {
                const img = document.createElement('img');
                img.src = image;
                imagesDiv.appendChild(img);
            });
            reviewDiv.appendChild(imagesDiv);
        }

        reviewsSection.appendChild(reviewDiv);
    });
}

// Create star elements based on rating
function createStars(rating) {
    let stars = '';
    for (let i = 1; i <= 5; i++) {
        if (i <= rating) {
            stars += '<span class="star selected">&#9733;</span>';
        } else {
            stars += '<span class="star">&#9733;</span>';
        }
    }
    return stars;
}
    });
    
    
</script>

        
    </main>
    
    <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-59bd"><div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-small-text u-text u-text-variant u-text-1"><b>«</b>ООО «ТДВ Инжиниринг»<b>»</b>
          <br>
          <br>&nbsp; &nbsp; &nbsp;Адрес: 450105, Республика
Башкортостан, город Уфа, ул. Юрия Гагарина, д. 28

Тел.: 8&nbsp;917&nbsp;486-777-6&nbsp;<br>E-mail: TDV-Engineering@mail.ru&nbsp;<br>ОГРН 1170280020316&nbsp;<br>ИНН 0276921062<br>&nbsp; КПП 027601001&nbsp;&nbsp;
        </p>
      </div></footer>

  
</body></html>